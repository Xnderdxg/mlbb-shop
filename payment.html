<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Безопасная оплата | MLBB</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background-color: #0d1117; color: #c9d1d9; font-family: sans-serif; display: flex; align-items: center; justify-content: center; min-height: 100vh; margin: 0; padding: 20px; }
        .pay-card { background: #161b22; border: 1px solid #30363d; border-radius: 20px; padding: 30px; width: 100%; max-width: 450px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .merchant-name { color: #c6a34f; font-weight: bold; font-size: 1.1rem; text-align: center; margin-bottom: 20px; text-transform: uppercase; }
        .order-info { background: #090c10; border-radius: 12px; padding: 15px; margin-bottom: 20px; border-left: 4px solid #c6a34f; }
        .method-item { background: #21262d; border: 1px solid #30363d; border-radius: 12px; padding: 15px; margin-bottom: 10px; cursor: pointer; display: flex; align-items: center; transition: 0.2s; }
        .method-item:hover { border-color: #c6a34f; background: #2d333b; }
        .method-item.active { border-color: #c6a34f; background: rgba(198, 163, 79, 0.1); }
        .method-item i { font-size: 1.5rem; width: 40px; color: #c6a34f; text-align: center; margin-right: 15px; }
        .total-pay { font-size: 1.8rem; font-weight: bold; text-align: center; margin: 25px 0; color: white; }
        .btn-pay-now { background: #c6a34f; color: black; font-weight: bold; width: 100%; padding: 16px; border-radius: 12px; border: none; text-transform: uppercase; }
        
        /* Модальное окно */
        #payModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000; align-items: center; justify-content: center; }
        .modal-content-pay { background: #161b22; border: 1px solid #30363d; border-radius: 20px; padding: 25px; width: 90%; max-width: 380px; position: relative; }
        .card-input { background: #0d1117; border: 1px solid #30363d; color: white; padding: 12px; border-radius: 8px; width: 100%; margin-bottom: 15px; outline: none; }
        .close-btn { position: absolute; top: 15px; right: 20px; cursor: pointer; color: #8b949e; }
    </style>
</head>
<body>

<div class="pay-card">
    <div class="merchant-name"><i class="fas fa-shield-alt me-2"></i> Secure Checkout</div>
    
    <div class="order-info">
        <div class="small text-secondary">Товар: <b id="outItem" class="text-white">Загрузка...</b></div>
        <div class="small text-secondary">Аккаунт: <b id="outAccount" class="text-white">Загрузка...</b></div>
    </div>

    <div class="method-item active" id="m-apple" onclick="selectMethod('apple')">
        <i class="fab fa-apple"></i>
        <div><b>Apple Pay</b></div>
    </div>
    <div class="method-item" id="m-google" onclick="selectMethod('google')">
        <i class="fab fa-google"></i>
        <div><b>Google Pay</b></div>
    </div>
    <div class="method-item" id="m-card" onclick="selectMethod('card')">
        <i class="fas fa-credit-card"></i>
        <div><b>Банковская карта</b><br><small class="text-secondary">UAH, RUB, USD</small></div>
    </div>

    <div class="total-pay"><span id="outPrice">0</span> ₽</div>

    <button class="btn-pay-now" onclick="openPayModal()">ПОДТВЕРДИТЬ И ОПЛАТИТЬ</button>
</div>

<div id="payModal">
    <div class="modal-content-pay">
        <span class="close-btn" onclick="closePayModal()"><i class="fas fa-times"></i></span>
        <h5 id="modalTitle" class="mb-4">Оплата</h5>
        
        <div id="cardFields" style="display:none;">
            <input type="text" class="card-input" placeholder="Номер карты">
            <div class="d-flex gap-2">
                <input type="text" class="card-input" placeholder="ММ/ГГ">
                <input type="password" class="card-input" placeholder="CVC">
            </div>
        </div>

        <div id="expressFields" class="text-center py-4">
            <i id="expressIcon" class="fab fa-apple fa-4x mb-3"></i>
            <p id="expressText">Подтвердите оплату</p>
        </div>

        <button class="btn-pay-now mt-2" onclick="processPayment()">ОПЛАТИТЬ СЕЙЧАС</button>
    </div>
</div>

<script>
    // 1. Получаем данные из URL сразу при загрузке
    window.onload = function() {
        const params = new URLSearchParams(window.location.search);
        
        const item = params.get('item') || "Не выбран";
        const price = params.get('price') || "0";
        const uid = params.get('uid') || "—";
        const zid = params.get('zid') || "—";

        document.getElementById('outItem').innerText = item;
        document.getElementById('outPrice').innerText = price;
        document.getElementById('outAccount').innerText = uid + " (" + zid + ")";
    };

    let selectedMethod = 'apple';

    // 2. Функция выбора метода
    function selectMethod(method) {
        selectedMethod = method;
        // Убираем активный класс у всех
        document.getElementById('m-apple').classList.remove('active');
        document.getElementById('m-google').classList.remove('active');
        document.getElementById('m-card').classList.remove('active');
        // Добавляем выбранному
        document.getElementById('m-' + method).classList.add('active');
    }

    // 3. Открытие модального окна
    function openPayModal() {
        const modal = document.getElementById('payModal');
        const cardF = document.getElementById('cardFields');
        const exprF = document.getElementById('expressFields');
        const icon = document.getElementById('expressIcon');
        const title = document.getElementById('modalTitle');

        modal.style.display = 'flex';

        if(selectedMethod === 'card') {
            cardF.style.display = 'block';
            exprF.style.display = 'none';
            title.innerText = "Оплата картой";
        } else {
            cardF.style.display = 'none';
            exprF.style.display = 'block';
            title.innerText = selectedMethod === 'apple' ? "Apple Pay" : "Google Pay";
            icon.className = selectedMethod === 'apple' ? "fab fa-apple fa-4x mb-3" : "fab fa-google fa-4x mb-3";
        }
    }

    function closePayModal() {
        document.getElementById('payModal').style.display = 'none';
    }

    function processPayment() {
        alert('Соединение с банком... Пожалуйста, не закрывайте окно.');
    }
</script>

</body>
</html>
